<nz-card class="w-full rounded-xl! p-2!">
  <h1 class="text-xl">
    <i class="fa-solid fa-utensils"></i>
    Platos consumidos
  </h1>
  <div class="flex flex-col gap-4 mt-5">
    <div class="flex flex-col gap-1">
      <label for="">Agregar consumo</label>
      <div class="flex gap-3">
        <nz-select
          #selectPlato
          nzShowSearch
          [(ngModel)]="platoSeleccionado"
          nzAllowClear
          [nzOptions]="opcionesDePlatos()"
          nzPlaceHolder="Seleccione un plato"
          [nzSize]="'large'"
          class="w-full"
        >
        </nz-select>
        <button
          nz-button
          nzType="primary"
          [nzSize]="'large'"
          nz-tooltip
          nzTooltipTitle="Agregar plato"
          [disabled]="!platoSeleccionado"
          (click)="agregarPlato(platoSeleccionado!)"
        >
          <i class="fas fa-plus"></i>
        </button>
      </div>
    </div>
    <div class="flex flex-col gap-1">
      <label for="">Seleccionar mesa</label>
      <div class="flex gap-3">
        <nz-select
          #selectMesa
          nzShowSearch
          [(ngModel)]="mesaSeleccionada"
          [nzOptions]="opcionesDeMesas()"
          (nzOpenChange)="seleccionarMesa(selectMesa.activatedValue)"
          nzPlaceHolder="Seleccione una mesa"
          [nzSize]="'large'"
          class="w-full"
        >
        </nz-select>
      </div>
    </div>
  </div>
  <div class="mt-5">
    <nz-table #smallTable [nzShowPagination]="false" nzSize="small" [nzData]="platosSeleccionados()" nzBordered>
      <thead>
        <tr>
          <th>Plato</th>
          <th>Precio</th>
          <th>Cantidad</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        @for (data of smallTable.data; track data.id) {
        <tr>
          <td>{{ data.plato }}</td>
          <td class="text-end">{{ data.valor | currency : '' : 'symbol' : '1.0-0' }}</td>
          <td class="text-center">
            <button
              nz-button
              nzType="default"
              nzShape="circle"
              [nzSize]="'small'"
              (click)="restarCantidad(data.id)"
            >
              <i class="fa-solid fa-minus"></i>
            </button>
            <span class="px-2">
              {{ data.cantidad || 1 }}
            </span>
            <button
              nz-button
              nzType="default"
              nzShape="circle"
              [nzSize]="'small'"
              (click)="agregarPlato(data.id)"
            >
              <i class="fa-solid fa-plus"></i>
            </button>
          </td>
          <td class="flex justify-center">
            <button
              nz-button
              nzType="default"
              [nzSize]="'small'"
              nz-tooltip
              nzDanger
              nzTooltipTitle="Eliminar plato"
              nz-popconfirm
              nzPopconfirmTitle="¿Está seguro de eliminar este consumo?"
              (nzOnConfirm)="confirm(data.id)"
              nzPopconfirmPlacement="top"
            >
              <i class="fas fa-trash"></i>
            </button>
          </td>
        </tr>
        }
      </tbody>
    </nz-table>
  </div>
</nz-card>
